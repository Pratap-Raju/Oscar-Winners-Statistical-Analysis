# ------------------------

# Note: we use # to annotate our codes as R ignores anything after #.


# You should save the Introlab-Data.txt data file in a folder called “Lab #1” and set the working directory to this folder.


#           Part 1: Summarizing and Displaying Categorical Data 


#----

# Importing Introlab-Data.txt data into R

Lab1.data <- read.table("Introlab-Data.txt", header=TRUE)

Lab1.data


#----

# Adding a coulmn called "Smoker" to the data set

Smoker = c(1, rep(0,6), 1, rep(0,3), rep(1,2),0)

Lab1.data = cbind(Lab1.data, Smoker)

Lab1.data


#----

# Accessing Varaibles in the data set in version 4.20.0


attach(Lab1.data)

Gender

class(Gender)


#----

Age

Systolic

Gender

Gender =="F"

Systolic[Gender =="F"]


Systolic[Gender =="F" & Age >45]


#----

# Accessing Varaibles in the data set in older version of R

attach(Lab1.data)

Gender

class(Gender)

levels(Gender)

class(levels(Gender))


#----

Age

Systolic

Gender

as.character(Gender) =="F"

Systolic[as.character(Gender) =="F"]


Systolic[as.character(Gender) =="F" & Age >45]


#----

# Creating class intervals. 

Systolic

Bins = cut(Systolic,5)  # Divide Systolic into five class intervals
Bins

data.frame(Systolic,Bins)

#----

# Creating bins using seq(0 function. 


bins = seq(96, by =20, length=5)
bins

Bins = as.character(cut(Systolic,bins, right=FALSE))
data.frame(Systolic,  Bins)


#----

# Creating a frequency table

table(Gender)       # Frequency table for "Gender"

table(Gender)/length(Gender)  #Relative frequency for "Gender"


#----

# Creating a nicer version of a frequency table


table(Gender) 

data.frame(table(Gender))


install.packages("gmodels")

library(gmodels)

CrossTable(Gender)

# You may use help(CrossTable) to know more about CrossTable() function


#----

# Creating a frequency table for part of data

table(Gender[Systolic >135])  #Frequency table for Gender with systolic > 135

table(Gender[Systolic >135])/length(Gender[Systolic >135]) #Relative Frequency table for Gender with systolic > 135


data.frame(table(Gender[Systolic >135])) #Frequency table for Gender with systolic > 135

CrossTable(Gender[Systolic >135])


#----

# Obtaining sunset of data set

subset(Lab1.data, Systolic>135)

subset(Lab1.data, Systolic>135)$Gender

CrossTable(subset(Lab1.data, Systolic>135)$Gender)

#----

# Making a contingency table

table(Gender, Smoker)  # Contingency table between Gender and Smoker
 
#----

# Finding relative frequncies

sum(table(Gender, Smoker))  # Finding total number of observations.

table(Gender, Smoker)/sum(table(Gender, Smoker))  #Finding relative frequencies

#----

# Finding conditional frequencies

table(Gender, Smoker)

apply(table(Gender, Smoker), 1, sum)    # Finding sum of first variable (Row sum)

apply(table(Gender, Smoker), 2, sum)    # Finding sum of second variable (column sum)

table(Gender, Smoker)/apply(table(Gender, Smoker), 1, sum)  # Finding conditional frequencies for first variable (row)

t(table(Gender, Smoker))/apply(table(Gender, Smoker), 2, sum)  # Finding conditional frequencies for second variable (column)




#----

# Making a nicer contingency table

install.packages("gmodels")

library(gmodels)

CrossTable(Gender, Smoker)

#----


# Crating a Ba-Chart for a single variable

par(mfrow=c(2,2))

barplot(table(Gender), main="Bar Chart of Gender",xlab="Gender",
ylab="Frequency",col=c("blue", "red"))

barplot(sort(table(Gender), decreasing =TRUE), main="Bar Chart of Gender",xlab="Gender",
ylab="Frequency",col=c("red", "blue"), legend=TRUE)

barplot(table(Smoker), main="Bar Chart of Smoker",xlab="Smoker",
ylab="Frequency",col=c("blue", "red"), legend=TRUE)

barplot(sort(table(Smoker)), main="Bar Chart of Smoker",xlab="Smoker",
ylab="Frequency",col=c("red", "blue"))

#----

# Crating a Ba-Chart for a variable for each category of another variable 

par(mfrow=c(2,2))

barplot(table(Smoker, Gender), main="Bar Chart of Gender \n Grouped by Smoker \n Using Frequency", xlab="Gender",
ylab="Frequency",col=c("blue", "red"), beside = TRUE, legend=TRUE, args.legend = list(x = "topleft"))

barplot(table(Smoker, Gender)/sum(table(Smoker, Gender)), main="Bar Chart of Gender \n Grouped by Smoker \n Using Relative Frequency", xlab="Gender",
ylab=" Relative Frequency",col=c("blue", "red"), beside = TRUE, legend=TRUE, args.legend = list(x = "topleft"))

barplot(table(Gender, Smoker), main="Bar Chart of Smoker \n Grouped by Gender \n Using Frequency", xlab="Smoker",
ylab="Frequency",col=c("blue", "red"), beside = TRUE, legend=TRUE)

barplot(table(Gender, Smoker)/sum(table(Gender,Smoker)), main="Bar Chart of Smoker \n Grouped by Gender \n Using Relative Frequency", xlab="Smoker",
ylab="Relative Frequency",col=c("blue", "red"), beside = TRUE, legend=TRUE)


#----

# Creating a Segmented Bar Char


Data.per1 = table(Gender, Smoker)/apply(table(Gender, Smoker), 1,sum)*100

Data.per2 = table(Smoker, Gender)/apply(table(Gender, Smoker), 2,sum)*100


par(mfrow=c(2,2))

barplot(t(Data.per1), beside = TRUE, col = c("blue", "red"),
        legend = colnames(Data.per1), args.legend = list(x = "topleft"), ylim = c(0, 100), 
        xlab="Gender", ylab="Percentage", main="Bar-chart of \n Conditional Distribution \n Smoker for Gender")

barplot(t(Data.per1), col = c("blue", "red"),
        legend = colnames(Data.per1), args.legend = list(x = "center"), ylim = c(0, 100),
        xlab="Gender", ylab="Percentage", main="Segmented Bar-chart of \n Smoker Grouped by Gender")

barplot(t(Data.per2), beside = TRUE, col = c("blue", "red"),
        legend = colnames(Data.per2), args.legend = list(x = "topright"), ylim = c(0, 100),
        xlab="Smoker", ylab="Percentage", main="Bar-chart of \n Conditional Distribution \n Gender for Smoker")

barplot(t(Data.per2), col = c("blue", "red"),
        legend = colnames(Data.per2), args.legend = list(x = "center"), ylim = c(0, 100),
        xlab="Smoker", ylab="Percentage", main="Segmented Bar-chart of \n Gender Grouped by Smoker")


#----

# Creating pie chart



par(mfrow=c(3,2))


# Creating pie chart for Gender

slices.gender <-  as.vector(table(Gender))

lbls.gender <- c("Female","Male")

pct.gender <- round(slices.gender/sum(slices.gender)*100, digits=0)
lbls.gender <- paste(lbls.gender, "(", pct.gender,"%)",sep="") # add percents and % to labels 

pie(slices.gender,labels = lbls.gender, col=c("blue", "red"),
  	main="Pie Chart of Gender")

# Creating pie chart for smoker

slices.smoker <-  as.vector(table(Smoker))

lbls.smoker <- c("Non-smoker","Smoker")

pct.smoker <- round(slices.smoker/sum(slices.smoker)*100, digits=0)
lbls.smoker <- paste(lbls.smoker, "(", pct.smoker,"%)",sep="") # add percents and % to labels 

pie(slices.smoker,labels = lbls.smoker, col=c("blue", "red"),
  	main="Pie Chart of Smoker")

# Creating Pie chart of smoker grouped by gender

slices1.F = as.vector(t(table(Gender, Smoker)))[1:2]
slices1.M = as.vector(t(table(Gender, Smoker)))[3:4]


Data.per1 = table(Gender, Smoker)/apply(table(Gender, Smoker), 1,sum)*100

pct1.F = round(as.vector(t(Data.per1)), digits=0)[1:2]
pct1.M = round(as.vector(t(Data.per1)), digits=0)[3:4]

lbls1 <- c("Non-smoker","Smoker")
lbls1.F <- paste(lbls1, "(", pct1.F,"%)",sep="") # add percents and % to labels 
lbls1.M <- paste(lbls1, "(", pct1.M,"%)",sep="") # add percents and % to labels 

pie(slices1.F,labels = lbls1.F, col=c("blue", "red"),
  	main="Pie Chart of Smoker For Female")

pie(slices1.M,labels = lbls1.M, col=c("blue", "red"),
  	main="Pie Chart of Smoker For Male")


# Creating Pie chart of gender grouped by smoker

slices2.NS = as.vector(t(table(Smoker, Gender)))[1:2]
slices2.S = as.vector(t(table(Smoker, Gender)))[3:4]


Data.per2 = table(Smoker, Gender)/apply(table(Gender, Smoker), 2,sum)*100

pct2.NS = round(as.vector(t(Data.per2)), digits=0)[1:2]
pct2.S = round(as.vector(t(Data.per2)), digits=0)[3:4]

lbls2 <- c("Female","Male")
lbls2.NS <- paste(lbls2, "(", pct2.NS,"%)",sep="") # add percents and % to labels 
lbls2.S <-  paste(lbls2, "(", pct2.S,"%)",sep="") # add percents and % to labels 

pie(slices2.NS,labels = lbls2.NS, col=c("blue", "red"),
  	main="Pie Chart of Gender For Non-smoker")

pie(slices2.S,labels = lbls2.S, col=c("blue", "red"),
  	main="Pie Chart of Gender For Smoker")

#----

# ------------------------


#           Part 2: Summarizing and Displaying Quantitative Data 

# Calculating summary statistics
 
summary(Lab1.data)

summary(Age)

summary(Age[Gender == "F"])

summary(Age[Smoker == 0])

summary(Age[Gender =="F" & Smoker == 0])

#----


# Calculating Quartile

sort(Systolic)

summary(Systolic)

quantile(Systolic, prob=c(0,.25,.5,.75,1))


#----

# Calculating summary statistics using tapply() function 

summary(Systolic[Smoker == 0])

summary(Systolic[Smoker == 1])

tapply(Systolic, Smoker, summary)

tapply(Systolic[Gender == "F"], Smoker[Gender == "F"], summary)


#----

var(Age)  # Calculating variance

sd(Age)   # Calculating Standard deviation

IQR (Age) # Calculating inter-quartile range

range(Age)  # Find smallest and largest observations

max(Age)-min(Age)  # Calculating range

#----

# Creating Histogram

par(mfrow = c(2,2))

hist(Systolic,  main="(1): Histogram of \n Systolic Blood Pressure", xlab = "Systolic", col="blue")

hist(Systolic,  fre=FALSE, main="(2): Histogram of \n Systolic Blood Pressure", xlab = "Systolic", col="blue")

hist(Systolic,  breaks = 7, main="(3): Histogram of \n Systolic Blood Pressure", xlab = "Systolic", col="blue")

hist(Systolic,  breaks =c(90,105, 120, 135, 150, 165, 180),fre=FALSE, right = FALSE, 
main="(4): Histogram of \n Systolic Blood Pressure", xlab = "Systolic", col="blue")

#----

# Creating Histograms grouped by gender

par(mfrow = c(1,2))

hist(Systolic[Gender=="F"],  breaks =c(90,105, 120, 135, 150, 165, 180),fre=FALSE, right = FALSE, 
main="Histogram of \n Systolic Blood Pressure \n for Female", xlab = "Systolic", col="blue")

hist(Systolic[Gender=="M"],  breaks =c(90,105, 120, 135, 150, 165, 180),fre=FALSE, right = FALSE, 
main="Histogram of \n Systolic Blood Pressure \n for Male", xlab = "Systolic", col="blue")


#----

# Creating Histograms grouped by gender side-by-side

install.packages("plotrix")

library(plotrix)

# You may use require(plotrix)

l <- list(Systolic[Gender=="F"],Systolic[Gender=="M"])

par(mfrow = c(1,2))

multhist(l, fre=FALSE, col=c("blue", "red"),
          main = paste("Side by Side Histogram", "\n of Systolic Blood Pressure"))


legend("topleft", legend=c("Female", "Male"),lty=1,  col=c("blue", "red"), title="Gender")

multhist(l, beside=FALSE, fre=FALSE, col=c("blue", "red"),
          main = paste("Histogram", "\n of Systolic Blood Pressure"))

legend("topright", legend=c("Male", "Female"),lty=1,  col=c("blue", "red"), title="Gender")


#----


# Creatu=ing Box-plot

par(mfrow = c(1,2))

boxplot(Systolic,col= "yellow", main="Boxplot of \n of Systolic Blood Pressure")

L <- list(Systolic[Gender=="F"],Systolic[Gender=="M"])

names(L)= c("Female", "Male")

boxplot(L,col= c("red","blue"), main="Boxplot of \n of Systolic Blood Pressure Grouped by Gender")


#----

# Creating boxplot hosrizontally

par(mfrow = c(1,1))

boxplot(L,col= c("red","blue", "yellow"), main="Boxplot of \n of Systolic Blood Pressure
Grouped by Gender", horizontal =TRUE)

#----

# ------------------------

#           Part 3: Displaying Data over Time: Time Plots 


#----

# Importing data into R


Lab1.Data <- read.table("Lab1-Data.txt")

Lab1.Data

names(Lab1.Data) = c("Year", "Dep1","Dep2")

Lab1.Data


#----

# Creating Time plot

# First Method

plot(Lab1.Data$Year, Lab1.Data$Dep1, type = "b",  xlab="Year", ylab="Sales(in millions)", 
xlim=c(1998, 2005), ylim=c(60, 85), col = "blue", main ="Index plot of Sales \n By Departments")

par(new=TRUE)

plot(Lab1.Data$Year, Lab1.Data$Dep2, type = "b", axes = FALSE, col = "red", xlab="", ylab="")

text(2002, 83, "Sales over 1998-2005")
legend("topleft", legend=c("Department 1", "Department 2"),lty=1,  col=c("blue", "red"), 
title="Departments")

#----

# Second Method

plot(1, type="n", xlab="Year", ylab="Sales(in millions)", xlim=c(1998, 2005), ylim=c(60, 85), 
main ="Index plot of Sales \n By Departments")

lines(Lab1.Data$Year, Lab1.Data$Dep1, col="blue")
lines(Lab1.Data$Year, Lab1.Data$Dep2, col="red")

text(2002, 85, "Sales over 1998-2005")
legend("topleft", legend=c("Department 1", "Department 2"),lty=1,  col=c("blue", "red"), 
title="Departments")


#----



# ------------------------


